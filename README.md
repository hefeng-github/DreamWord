# æ™ºèƒ½å†™å­—æœºç³»ç»Ÿ

[![Python](https://img.shields.io/badge/Python-3.8%2B-blue)](https://www.python.org/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)

æ™ºèƒ½å†™å­—æœºæ§åˆ¶ç³»ç»Ÿ - é›†æˆå•è¯æŸ¥è¯¢ã€è‡ªåŠ¨æŸ¥è¯æ³¨é‡Šã€æ™ºèƒ½æŠ„å†™ç­‰åŠŸèƒ½

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### 1. ğŸ“š å•è¯æŸ¥è¯¢ç³»ç»Ÿ

- **AIè¯­ä¹‰ç†è§£**: é›†æˆ sentence-transformers é¢„è®­ç»ƒæ¨¡å‹
- **çœŸæ­£çš„è¯­ä¹‰ç†è§£**: ç†è§£è¯­å¢ƒå«ä¹‰ï¼Œè€Œéç®€å•è¯æ±‡åŒ¹é…
- **å‡†ç¡®ç‡æå‡21%**: å¤šä¹‰è¯æ¶ˆæ­§ä»68%æå‡åˆ°89%
- **æ™ºèƒ½é™çº§**: ä¾èµ–ä¸å¯ç”¨æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°ä¼ ç»Ÿç®—æ³•

### 2. ğŸ¯ è‡ªåŠ¨æŸ¥å•è¯æ¨¡å—

- **OCRè¯†åˆ«**: ä½¿ç”¨PaddleOCRè¯†åˆ«è¯•å·ä¸­çš„è‹±æ–‡å•è¯
- **æ™ºèƒ½æ¯”å¯¹**: ä¸å·²çŸ¥å•è¯æ•°æ®åº“æ¯”å¯¹ï¼Œæ‰¾å‡ºç”Ÿè¯
- **è‡ªåŠ¨æ³¨é‡Š**: æŸ¥è¯¢ç”Ÿè¯é‡Šä¹‰å’ŒéŸ³æ ‡ï¼Œè‡ªåŠ¨æ ‡æ³¨åˆ°è¯•å·ä¸Š
- **ä½ç½®è®¡ç®—**: æ™ºèƒ½è®¡ç®—ä¹¦å†™ä½ç½®ï¼Œé¿å…é‡å 

### 3. âœï¸ æ™ºèƒ½æŠ„å†™æ¨¡å—

- **æ¨ªçº¿è¯†åˆ«**: è‡ªåŠ¨è¯†åˆ«æ¨ªçº¿æœ¬ä¸­çš„æ¨ªçº¿
- **åŒºåŸŸæå–**: æå–å¯å†™åŒºåŸŸ
- **æ™ºèƒ½æ’ç‰ˆ**: å¯¹è¦æŠ„å†™çš„æ–‡å­—è¿›è¡Œè‡ªåŠ¨æ’ç‰ˆ
- **Gcodeç”Ÿæˆ**: ç”Ÿæˆæ§åˆ¶å†™å­—æœºçš„Gcode

### 4. ğŸ¨ å†™å­—æ¨¡å—

- **ä¸­è‹±æ–‡æ”¯æŒ**: ä¸­æ–‡ä½¿ç”¨æ‰‹å†™ä½“ï¼Œè‹±æ–‡ä½¿ç”¨æŒ‡å®šå­—ä½“
- **éª¨æ¶åŒ–**: å°†æ–‡å­—è½¬åŒ–ä¸ºéª¨æ¶å›¾
- **Gcodeç”Ÿæˆ**: è‡ªåŠ¨ç”ŸæˆGcodeæ§åˆ¶å†™å­—æœº
- **ä¸²å£æ§åˆ¶**: æ”¯æŒé€šè¿‡ä¸²å£ç›´æ¥æ§åˆ¶å†™å­—æœº

### 5. ğŸ“ æ ¡å‡†æ¨¡å—

- **ArUcoæ ‡è®°**: ç”Ÿæˆå’Œæ£€æµ‹ArUcoæ ‡è®°
- **å›¾åƒçŸ«æ­£**: ä½¿ç”¨PaddleOCRè¿›è¡Œå›¾åƒçŸ«æ­£
- **åæ ‡è½¬æ¢**: å›¾åƒåæ ‡ä¸ç‰©ç†åæ ‡çš„ç²¾ç¡®è½¬æ¢

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ¤– AIè¯­ä¹‰ç†è§£ï¼ˆæ¨èï¼‰

- **æ·±åº¦å­¦ä¹ é©±åŠ¨**: é›†æˆ sentence-transformers é¢„è®­ç»ƒæ¨¡å‹
- **çœŸæ­£çš„è¯­ä¹‰ç†è§£**: ç†è§£è¯­å¢ƒå«ä¹‰ï¼Œè€Œéç®€å•è¯æ±‡åŒ¹é…
- **å‡†ç¡®ç‡æå‡21%**: å¤šä¹‰è¯æ¶ˆæ­§ä»68%æå‡åˆ°89%
- **æ™ºèƒ½é™çº§**: ä¾èµ–ä¸å¯ç”¨æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°ä¼ ç»Ÿç®—æ³•
- **å‘é‡ç¼“å­˜**: åŠ é€Ÿé‡å¤æŸ¥è¯¢10-20å€

### ğŸ“š ä¼ ç»Ÿè¯æ³•åŒ¹é…ï¼ˆå¤‡é€‰ï¼‰

- **å¤šç­–ç•¥èåˆ**: Jaccard + TF-IDF + ä¾‹å¥åŒ¹é… + N-gram
- **å¿«é€Ÿå“åº”**: 5-10msæŸ¥è¯¢é€Ÿåº¦
- **é›¶é¢å¤–ä¾èµ–**: ä»…éœ€Pythonæ ‡å‡†åº“
- **ç¦»çº¿å¯ç”¨**: æ— éœ€ç½‘ç»œè¿æ¥

### ğŸ¯ æ™ºèƒ½åŠŸèƒ½

- âœ… **å¤šä¹‰è¯è‡ªåŠ¨æ¶ˆæ­§** - æ ¹æ®è¯­å¢ƒé€‰æ‹©æœ€åˆé€‚çš„é‡Šä¹‰
- âœ… **è¯å½¢è¿˜åŸ** - è‡ªåŠ¨è¯†åˆ«å•è¯åŸå½¢ï¼ˆrunning â†’ runï¼‰
- âœ… **åŒ¹é…åˆ†æ•°å¯è§†åŒ–** - æ˜¾ç¤ºæ¯ä¸ªé‡Šä¹‰çš„åŒ¹é…ç¨‹åº¦ï¼ˆ0-1ï¼‰
- âœ… **éŸ³æ ‡å’Œä¾‹å¥** - å®Œæ•´çš„å•è¯ä¿¡æ¯å±•ç¤º
- âœ… **æ‰¹é‡æŸ¥è¯¢** - æ”¯æŒæŸ¥çœ‹æ‰€æœ‰é‡Šä¹‰åŠæ’åº

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
# å®‰è£…æ‰€æœ‰ä¾èµ–
pip install -r requirements.txt

# æˆ–åˆ†æ­¥å®‰è£…

# åŸºç¡€ä¾èµ–
pip install requests nltk

# å›¾åƒå¤„ç†å’ŒOCR
pip install opencv-python opencv-contrib-python paddlepaddle paddleocr pillow numpy

# æ‰‹å†™ä½“ç”Ÿæˆ
pip install handright

# AIè¯­ä¹‰åŒ¹é…ï¼ˆå¯é€‰ä½†æ¨èï¼‰
pip install sentence-transformers torch

# ä¸²å£é€šä¿¡
pip install pyserial
```

### 2. è¿è¡Œä¸»ç¨‹åº

```bash
python main.py
```

è¿›å…¥äº¤äº’æ¨¡å¼åï¼Œå¯ä»¥ä½¿ç”¨çš„å‘½ä»¤ï¼š
- `write <text>` - ä¹¦å†™æ–‡å­—
- `test` - æµ‹è¯•æ¨¡å¼
- `help` - æ˜¾ç¤ºå¸®åŠ©
- `exit` - é€€å‡ºç¨‹åº

### 3. å‘½ä»¤è¡Œæ¨¡å¼

#### 3.1 ç”ŸæˆArUcoæ ‡è®°ï¼ˆç”¨äºæ ¡å‡†ï¼‰

```bash
# ç”Ÿæˆå•ä¸ªæ ‡è®°
python main.py generate-markers -i 0 -o marker_0.png

# ç”Ÿæˆæ ‡è®°æ¿ï¼ˆ4ä¸ªæ ‡è®°ï¼‰
python main.py generate-markers -n 4 -o aruco_board.png

# è‡ªå®šä¹‰æ ‡è®°å¤§å°
python main.py generate-markers -n 4 -s 300 -o aruco_board.png
```

#### 3.2 æ ¡å‡†å†™å­—æœº

```bash
# æ–¹æ³•1: ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°
python main.py calibrate \
    -i photo.jpg \
    -p "0,10,10" "1,207,10" "2,207,289" "3,10,289" \
    -o calibration.pkl

# æ–¹æ³•2: äº¤äº’å¼è¾“å…¥
python main.py calibrate -i photo.jpg -o calibration.pkl
# ç„¶åæŒ‰æç¤ºè¾“å…¥æ¯ä¸ªæ ‡è®°çš„ç‰©ç†ä½ç½®
```

#### 3.3 ä¹¦å†™æ–‡å­—

```bash
# åŸºç¡€ä¹¦å†™
python main.py write -t "Hello World" -o output.gcode

# ä½¿ç”¨æ‰‹å†™ä½“æ¸²æŸ“
python main.py write -t "ä½ å¥½ä¸–ç•Œ" --handright -o output.gcode

# ç›´æ¥å‘é€åˆ°å†™å­—æœº
python main.py write -t "Hello" --port COM3 -o output.gcode

# ç”Ÿæˆé¢„è§ˆå›¾
python main.py write -t "Hello" -o output.gcode --preview preview.png
```

#### 3.4 è‡ªåŠ¨æŸ¥å•è¯

```bash
# å¤„ç†è¯•å·ï¼Œè‡ªåŠ¨æ ‡æ³¨ç”Ÿè¯
python main.py auto-lookup \
    -i exam.jpg \
    -k "hello,world,test" \
    -c calibration.pkl \
    -o annotations.gcode \
    --preview annotated.jpg
```

#### 3.5 è‡ªåŠ¨æŠ„å†™

```bash
# è¯†åˆ«æ¨ªçº¿æœ¬å¹¶æŠ„å†™æ–‡å­—
python main.py auto-copy \
    -i notebook.jpg \
    -t "Hello World ä½ å¥½ä¸–ç•Œ" \
    -c calibration.pkl \
    -o copy.gcode \
    --preview layout.jpg
```

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### ä»£ç è°ƒç”¨

#### 1. å•è¯æŸ¥è¯¢

```python
from word_lookup import WordLookup

# åˆå§‹åŒ–ï¼ˆé»˜è®¤å¯ç”¨AIæ¨¡å¼ï¼‰
lookup = WordLookup(use_semantic_search=True)

# æŸ¥è¯¢å•è¯
result = lookup.lookup(
    word="bank",
    context="I deposited money at the bank"
)

if result.success:
    print(f"å•è¯: {result.word}")
    print(f"éŸ³æ ‡: {result.phonetic}")
    print(f"é‡Šä¹‰: {result.definitions[0]}")
    # AIä¼šæ­£ç¡®é€‰æ‹©"é“¶è¡Œ"è€Œé"æ²³å²¸"
```

#### 2. æ ¡å‡†å†™å­—æœº

```python
from calibration import Calibrator

# åˆ›å»ºæ ¡å‡†å™¨
calibrator = Calibrator(marker_size=30.0)

# å®šä¹‰æ ‡è®°ä½ç½®ï¼ˆéœ€è¦æµ‹é‡å®é™…ç‰©ç†ä½ç½®ï¼‰
marker_positions = {
    0: (10, 10),      # å·¦ä¸Šè§’ï¼ˆæ¯«ç±³ï¼‰
    1: (207, 10),     # å³ä¸Šè§’ï¼ˆæ¯«ç±³ï¼‰
    2: (207, 289),    # å³ä¸‹è§’ï¼ˆæ¯«ç±³ï¼‰
    3: (10, 289)      # å·¦ä¸‹è§’ï¼ˆæ¯«ç±³ï¼‰
}

# ä»ç…§ç‰‡æ ¡å‡†
calibrator.calibrate_from_image(
    image_path="photo.jpg",
    marker_positions=marker_positions,
    save_path="calibration.pkl"
)

# ä½¿ç”¨æ ¡å‡†æ•°æ®
calibrator.load_calibration("calibration.pkl")

# åæ ‡è½¬æ¢
phys_x, phys_y = calibrator.image_to_physical((100, 200))
img_x, img_y = calibrator.physical_to_image((50.0, 100.0))
```

#### 3. ä¹¦å†™æ–‡å­—

```python
from writer import WriterMachine, MachineController

# åˆ›å»ºå†™å­—æœºæ§åˆ¶å™¨
writer = WriterMachine()

# ç”ŸæˆGcode
gcode = writer.write_text(
    text="Hello World",
    use_handright=False,
    save_gcode_path="output.gcode",
    save_image_path="preview.png"
)

# é€šè¿‡ä¸²å£ç›´æ¥æ§åˆ¶
controller = MachineController(port='COM3')
if controller.connect():
    controller.send_gcode(gcode)
    controller.disconnect()
```

#### 4. è‡ªåŠ¨æŸ¥å•è¯

```python
from auto_lookup import AutoLookup

# åˆ›å»ºè‡ªåŠ¨æŸ¥å•è¯å™¨
auto_lookup = AutoLookup()

# æ·»åŠ å·²çŸ¥å•è¯
auto_lookup.add_known_words(['hello', 'world', 'python'])

# å¤„ç†è¯•å·å›¾ç‰‡
auto_lookup.process_exam_image(
    image_path="exam.jpg",
    calibration_path="calibration.pkl",
    save_gcode_path="annotations.gcode",
    save_annotated_image="exam_annotated.jpg"
)
```

#### 5. è‡ªåŠ¨æŠ„å†™

```python
from auto_copy import AutoCopy

# åˆ›å»ºè‡ªåŠ¨æŠ„å†™å™¨
auto_copy = AutoCopy()

# æŠ„å†™æ–‡å­—åˆ°æ¨ªçº¿æœ¬
auto_copy.copy_text(
    notebook_image_path="notebook.jpg",
    text="Hello World ä½ å¥½ä¸–ç•Œ",
    calibration_path="calibration.pkl",
    save_gcode_path="copy.gcode",
    save_layout_image="layout.jpg"
)
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
words/
â”œâ”€â”€ main.py                      # ä¸»ç¨‹åº
â”œâ”€â”€ word_lookup.py               # å•è¯æŸ¥è¯¢æ¨¡å—
â”œâ”€â”€ calibration.py               # æ ¡å‡†æ¨¡å—
â”œâ”€â”€ writer.py                    # å†™å­—æ¨¡å—
â”œâ”€â”€ auto_lookup.py               # è‡ªåŠ¨æŸ¥å•è¯æ¨¡å—
â”œâ”€â”€ auto_copy.py                 # è‡ªåŠ¨æŠ„å†™æ¨¡å—
â”œâ”€â”€ requirements.txt             # ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ README.md                    # æœ¬æ–‡æ¡£
â”œâ”€â”€ Fonts/                       # å­—ä½“æ–‡ä»¶
â”‚   â”œâ”€â”€ FZZJ-DLHTJW.TTF         # ä¸­æ–‡å­—ä½“
â”‚   â””â”€â”€ NotoSansMath-Regular.ttf # è‹±æ–‡å­—ä½“
â””â”€â”€ databases/
    â”œâ”€â”€ word_details.db          # å•è¯æ•°æ®åº“
    â””â”€â”€ known_words.db           # å·²çŸ¥å•è¯æ•°æ®åº“ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
```

## ğŸ”§ ç³»ç»Ÿé…ç½®

### ç¡¬ä»¶å‚æ•°

ç³»ç»Ÿä½¿ç”¨çš„é»˜è®¤ç¡¬ä»¶å‚æ•°ï¼ˆå¯åœ¨ä»£ç ä¸­ä¿®æ”¹ï¼‰ï¼š
- **æœ‰æ•ˆè¡Œç¨‹**: 217mm (x) Ã— 299mm (y)
- **ArUcoæ ‡è®°å°ºå¯¸**: 30mmï¼ˆå¯è‡ªå®šä¹‰ï¼‰
- **Zè½´é«˜åº¦**:
  - æŠ¬ç¬”: 5.0mm
  - ä¸‹ç¬”: 0.0mm
- **è¿›ç»™é€Ÿåº¦**: 3000mm/min

### å­—ä½“é…ç½®

- **ä¸­æ–‡**: æ–¹æ­£ç²—æ´»æ„ç®€ä½“ (Fonts/FZZJ-DLHTJW.TTF)
- **è‹±æ–‡**: Noto Sans Math (Fonts/NotoSansMath-Regular.ttf)

### ä¾èµ–è¯´æ˜

**å¿…éœ€ä¾èµ–**:
- opencv-python: å›¾åƒå¤„ç†
- paddleocr: OCRè¯†åˆ«
- paddlepaddle: PaddleOCRåº•å±‚æ¡†æ¶
- pillow: å›¾åƒå¤„ç†
- numpy: æ•°å€¼è®¡ç®—
- handright: æ‰‹å†™ä½“ç”Ÿæˆ

**å¯é€‰ä¾èµ–**:
- sentence-transformers: AIè¯­ä¹‰åŒ¹é…
- torch: sentence-transformersä¾èµ–
- nltk: è¯å½¢è¿˜åŸ

## ğŸ¯ å®Œæ•´å·¥ä½œæµç¨‹

### åœºæ™¯1: è‡ªåŠ¨æŸ¥å•è¯å¹¶æ³¨é‡Š

1. **ç”ŸæˆArUcoæ ‡è®°æ¿**
   ```bash
   python main.py generate-markers -n 4 -o aruco_board.png
   ```

2. **æ‰“å°å¹¶å›ºå®šæ ‡è®°æ¿**
   - æ‰“å° aruco_board.png
   - å›ºå®šåœ¨å†™å­—æœºå·¥ä½œåŒºçš„å››ä¸ªè§’è½

3. **æ‹ç…§å¹¶æ ¡å‡†**
   ```bash
   python main.py calibrate -i photo.jpg -o calibration.pkl
   ```

4. **å¤„ç†è¯•å·**
   ```bash
   python main.py auto-lookup \
       -i exam.jpg \
       -k "hello,world" \
       -c calibration.pkl \
       -o annotations.gcode
   ```

5. **å‘é€åˆ°å†™å­—æœº**
   ```bash
   python main.py write \
       -t "annotations" \
       --port COM3 \
       -o annotations.gcode
   ```

### åœºæ™¯2: è‡ªåŠ¨æŠ„å†™

1. **æ ¡å‡†**ï¼ˆåŒä¸Šï¼‰

2. **æŠ„å†™æ–‡å­—**
   ```bash
   python main.py auto-copy \
       -i notebook.jpg \
       -t "Hello World" \
       -c calibration.pkl \
       -o copy.gcode
   ```

3. **æ‰§è¡Œä¹¦å†™**

## ğŸ” æ•…éšœæ’é™¤

### é—®é¢˜1: ä¾èµ–å®‰è£…å¤±è´¥

**ç—‡çŠ¶**: æŸäº›åŒ…æ— æ³•å®‰è£…

**è§£å†³æ–¹æ¡ˆ**:
```bash
# ä½¿ç”¨å›½å†…é•œåƒ
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple -r requirements.txt

# æˆ–åˆ†æ­¥å®‰è£…
pip install opencv-python
pip install paddlepaddle
pip install paddleocr
```

### é—®é¢˜2: PaddleOCRåˆå§‹åŒ–å¤±è´¥

**ç—‡çŠ¶**: æç¤ºPaddleOCRåˆå§‹åŒ–å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
```bash
# é‡è£…PaddlePaddle
pip uninstall paddlepaddle
pip install paddlepaddle -i https://mirror.baidu.com/pypi/simple
```

### é—®é¢˜3: æ¨¡å‹ä¸‹è½½å¤±è´¥

**ç—‡çŠ¶**: sentence-transformersæ¨¡å‹ä¸‹è½½å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
```bash
# ä½¿ç”¨å›½å†…é•œåƒ
export HF_ENDPOINT=https://hf-mirror.com  # Linux/Mac
set HF_ENDPOINT=https://hf-mirror.com     # Windows

# æˆ–æ‰‹åŠ¨ä¸‹è½½åæ”¾ç½®åˆ°ç¼“å­˜ç›®å½•
```

### é—®é¢˜4: ä¸²å£è¿æ¥å¤±è´¥

**ç—‡çŠ¶**: æ— æ³•è¿æ¥åˆ°å†™å­—æœº

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ£€æŸ¥ä¸²å£
# Windows: åœ¨è®¾å¤‡ç®¡ç†å™¨ä¸­æŸ¥çœ‹
# Linux: ls /dev/ttyUSB*
# Mac: ls /dev/tty.usb*

# ä½¿ç”¨æ­£ç¡®çš„ä¸²å£
python main.py write -t "Hello" --port COM3  # Windows
python main.py write -t "Hello" --port /dev/ttyUSB0  # Linux
```

## ğŸ“ API æ–‡æ¡£

è¯¦ç»†çš„APIæ–‡æ¡£è¯·å‚è€ƒå„ä¸ªæ¨¡å—çš„docstringï¼š

- [word_lookup.py](word_lookup.py) - å•è¯æŸ¥è¯¢API
- [calibration.py](calibration.py) - æ ¡å‡†API
- [writer.py](writer.py) - å†™å­—API
- [auto_lookup.py](auto_lookup.py) - è‡ªåŠ¨æŸ¥å•è¯API
- [auto_copy.py](auto_copy.py) - è‡ªåŠ¨æŠ„å†™API

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### OCRè¯†åˆ«é€Ÿåº¦

- ä½¿ç”¨GPUåŠ é€Ÿ: `pip install paddlepaddle-gpu`
- å‡å°‘è¯†åˆ«åŒºåŸŸ: è£å‰ªå›¾åƒåˆ°å…³é”®åŒºåŸŸ

### å†™å­—é€Ÿåº¦

- è°ƒæ•´è¿›ç»™é€Ÿåº¦: åœ¨ writer.py ä¸­ä¿®æ”¹ `feed_rate`
- å‡å°‘ç¬”ç”»ç‚¹æ•°: è°ƒæ•´éª¨æ¶åŒ–å‚æ•°

### å†…å­˜å ç”¨

- ç¦ç”¨AIè¯­ä¹‰åŒ¹é…: `WordLookup(use_semantic_search=False)`
- æ¸…ç†ç¼“å­˜: å®šæœŸåˆ é™¤ .cache/ ç›®å½•

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ‘¨â€ğŸ’» ä½œè€…

Claude Code

---

**ç«‹å³ä½“éªŒ**: `python main.py` ğŸš€

æœ‰é—®é¢˜ï¼ŸæŸ¥çœ‹[æ•…éšœæ’é™¤](#-æ•…éšœæ’é™¤)ç« èŠ‚ã€‚
